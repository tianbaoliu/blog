<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>常用方法封装 | 天宝的博客</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="ltbicon.ico">
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.a7a7e01f.css" as="style"><link rel="preload" href="/assets/js/app.1aa2a0f6.js" as="script"><link rel="preload" href="/assets/js/3.0eb5227a.js" as="script"><link rel="preload" href="/assets/js/1.47d7d4b6.js" as="script"><link rel="preload" href="/assets/js/119.98962333.js" as="script"><link rel="prefetch" href="/assets/js/10.8873a8c5.js"><link rel="prefetch" href="/assets/js/100.75214b2f.js"><link rel="prefetch" href="/assets/js/101.d7e10aed.js"><link rel="prefetch" href="/assets/js/102.a802fa26.js"><link rel="prefetch" href="/assets/js/103.2bd3f5cf.js"><link rel="prefetch" href="/assets/js/104.b82e3c16.js"><link rel="prefetch" href="/assets/js/105.0e864923.js"><link rel="prefetch" href="/assets/js/106.06b672f1.js"><link rel="prefetch" href="/assets/js/107.c6e4ffab.js"><link rel="prefetch" href="/assets/js/108.635143a1.js"><link rel="prefetch" href="/assets/js/109.74f39ef4.js"><link rel="prefetch" href="/assets/js/11.124f869e.js"><link rel="prefetch" href="/assets/js/110.3bb26fe1.js"><link rel="prefetch" href="/assets/js/111.9970a0b3.js"><link rel="prefetch" href="/assets/js/112.faee7154.js"><link rel="prefetch" href="/assets/js/113.6b841150.js"><link rel="prefetch" href="/assets/js/114.9580cf82.js"><link rel="prefetch" href="/assets/js/115.43fa29b3.js"><link rel="prefetch" href="/assets/js/116.935a74b2.js"><link rel="prefetch" href="/assets/js/117.4254d6a2.js"><link rel="prefetch" href="/assets/js/118.3d4dd0ae.js"><link rel="prefetch" href="/assets/js/12.603466b8.js"><link rel="prefetch" href="/assets/js/120.ced6b99e.js"><link rel="prefetch" href="/assets/js/121.ccd81d4f.js"><link rel="prefetch" href="/assets/js/122.8d9244f4.js"><link rel="prefetch" href="/assets/js/123.eb3ec25c.js"><link rel="prefetch" href="/assets/js/124.3ce10a38.js"><link rel="prefetch" href="/assets/js/125.1d8fe1a9.js"><link rel="prefetch" href="/assets/js/126.5347ea14.js"><link rel="prefetch" href="/assets/js/127.a7bdd88b.js"><link rel="prefetch" href="/assets/js/128.039968cf.js"><link rel="prefetch" href="/assets/js/129.db978de6.js"><link rel="prefetch" href="/assets/js/13.4f40b008.js"><link rel="prefetch" href="/assets/js/130.647ef7a4.js"><link rel="prefetch" href="/assets/js/131.760e43f5.js"><link rel="prefetch" href="/assets/js/132.cdbb7f9c.js"><link rel="prefetch" href="/assets/js/133.3ba7ea1e.js"><link rel="prefetch" href="/assets/js/134.a5915503.js"><link rel="prefetch" href="/assets/js/135.86bd43c1.js"><link rel="prefetch" href="/assets/js/136.924d19c6.js"><link rel="prefetch" href="/assets/js/137.639eeabc.js"><link rel="prefetch" href="/assets/js/138.cae7abcc.js"><link rel="prefetch" href="/assets/js/139.5b14c4cd.js"><link rel="prefetch" href="/assets/js/14.6df7fff0.js"><link rel="prefetch" href="/assets/js/140.7b0327d3.js"><link rel="prefetch" href="/assets/js/141.2e1ef077.js"><link rel="prefetch" href="/assets/js/142.5cf67af5.js"><link rel="prefetch" href="/assets/js/143.174289b0.js"><link rel="prefetch" href="/assets/js/144.9a4ac517.js"><link rel="prefetch" href="/assets/js/145.c71919e5.js"><link rel="prefetch" href="/assets/js/146.522ba5e1.js"><link rel="prefetch" href="/assets/js/147.735b02b7.js"><link rel="prefetch" href="/assets/js/148.38ab89ba.js"><link rel="prefetch" href="/assets/js/149.72809770.js"><link rel="prefetch" href="/assets/js/15.2cc4e7b4.js"><link rel="prefetch" href="/assets/js/150.33b52a68.js"><link rel="prefetch" href="/assets/js/151.6cbfcdf9.js"><link rel="prefetch" href="/assets/js/152.0a513de7.js"><link rel="prefetch" href="/assets/js/153.5860859c.js"><link rel="prefetch" href="/assets/js/154.bf115ac4.js"><link rel="prefetch" href="/assets/js/155.41556a70.js"><link rel="prefetch" href="/assets/js/156.f2a1b4c8.js"><link rel="prefetch" href="/assets/js/157.eb404ec2.js"><link rel="prefetch" href="/assets/js/158.76d7e1d1.js"><link rel="prefetch" href="/assets/js/159.5b9426eb.js"><link rel="prefetch" href="/assets/js/16.3821ce58.js"><link rel="prefetch" href="/assets/js/160.880b0add.js"><link rel="prefetch" href="/assets/js/161.06483f99.js"><link rel="prefetch" href="/assets/js/162.144ca27a.js"><link rel="prefetch" href="/assets/js/163.de1f884e.js"><link rel="prefetch" href="/assets/js/164.7533f9fa.js"><link rel="prefetch" href="/assets/js/165.8257679d.js"><link rel="prefetch" href="/assets/js/17.467b8b18.js"><link rel="prefetch" href="/assets/js/18.db834122.js"><link rel="prefetch" href="/assets/js/19.7dc1f871.js"><link rel="prefetch" href="/assets/js/20.8627c767.js"><link rel="prefetch" href="/assets/js/21.9ad925ae.js"><link rel="prefetch" href="/assets/js/22.73b3c6ab.js"><link rel="prefetch" href="/assets/js/23.2551f809.js"><link rel="prefetch" href="/assets/js/24.8677f40e.js"><link rel="prefetch" href="/assets/js/25.7fc02be7.js"><link rel="prefetch" href="/assets/js/26.7092f918.js"><link rel="prefetch" href="/assets/js/27.7153ef50.js"><link rel="prefetch" href="/assets/js/28.dd0c3cfc.js"><link rel="prefetch" href="/assets/js/29.76e834d7.js"><link rel="prefetch" href="/assets/js/30.6d8e6c3a.js"><link rel="prefetch" href="/assets/js/31.9a5a3d9d.js"><link rel="prefetch" href="/assets/js/32.d52c12ed.js"><link rel="prefetch" href="/assets/js/33.1aa9cf93.js"><link rel="prefetch" href="/assets/js/34.1a3484c8.js"><link rel="prefetch" href="/assets/js/35.9f0ae752.js"><link rel="prefetch" href="/assets/js/36.23a2eaf5.js"><link rel="prefetch" href="/assets/js/37.dbfb4849.js"><link rel="prefetch" href="/assets/js/38.8e08f4ac.js"><link rel="prefetch" href="/assets/js/39.9f73485e.js"><link rel="prefetch" href="/assets/js/4.827c63cc.js"><link rel="prefetch" href="/assets/js/40.e9026e9b.js"><link rel="prefetch" href="/assets/js/41.bec4aa5f.js"><link rel="prefetch" href="/assets/js/42.00989d37.js"><link rel="prefetch" href="/assets/js/43.7a1b2b32.js"><link rel="prefetch" href="/assets/js/44.1e48416f.js"><link rel="prefetch" href="/assets/js/45.e6cab9e9.js"><link rel="prefetch" href="/assets/js/46.eb4e0e29.js"><link rel="prefetch" href="/assets/js/47.1cf46c1a.js"><link rel="prefetch" href="/assets/js/48.5f5bbe25.js"><link rel="prefetch" href="/assets/js/49.bf2408c5.js"><link rel="prefetch" href="/assets/js/5.45876322.js"><link rel="prefetch" href="/assets/js/50.fefa12c9.js"><link rel="prefetch" href="/assets/js/51.b7fdf9ea.js"><link rel="prefetch" href="/assets/js/52.6de27e66.js"><link rel="prefetch" href="/assets/js/53.012ad4cd.js"><link rel="prefetch" href="/assets/js/54.7315ce14.js"><link rel="prefetch" href="/assets/js/55.d2527b46.js"><link rel="prefetch" href="/assets/js/56.ee533c2b.js"><link rel="prefetch" href="/assets/js/57.57a367a8.js"><link rel="prefetch" href="/assets/js/58.b1f2a2fa.js"><link rel="prefetch" href="/assets/js/59.9f33e20e.js"><link rel="prefetch" href="/assets/js/6.e9c2a761.js"><link rel="prefetch" href="/assets/js/60.e76b7553.js"><link rel="prefetch" href="/assets/js/61.2ff75e19.js"><link rel="prefetch" href="/assets/js/62.dc27ceed.js"><link rel="prefetch" href="/assets/js/63.b5a88ebe.js"><link rel="prefetch" href="/assets/js/64.7161b504.js"><link rel="prefetch" href="/assets/js/65.ba751267.js"><link rel="prefetch" href="/assets/js/66.107b8739.js"><link rel="prefetch" href="/assets/js/67.23d91b35.js"><link rel="prefetch" href="/assets/js/68.77c7ad98.js"><link rel="prefetch" href="/assets/js/69.c2e7297f.js"><link rel="prefetch" href="/assets/js/7.791ffe16.js"><link rel="prefetch" href="/assets/js/70.25106d2b.js"><link rel="prefetch" href="/assets/js/71.0eb8af30.js"><link rel="prefetch" href="/assets/js/72.5a69e4cf.js"><link rel="prefetch" href="/assets/js/73.5ed13df1.js"><link rel="prefetch" href="/assets/js/74.87b7a5a0.js"><link rel="prefetch" href="/assets/js/75.295a30cf.js"><link rel="prefetch" href="/assets/js/76.fb6decb6.js"><link rel="prefetch" href="/assets/js/77.f07a65c5.js"><link rel="prefetch" href="/assets/js/78.f74ac6e9.js"><link rel="prefetch" href="/assets/js/79.55aec1c8.js"><link rel="prefetch" href="/assets/js/8.2cce7b77.js"><link rel="prefetch" href="/assets/js/80.0fceca43.js"><link rel="prefetch" href="/assets/js/81.23303cb4.js"><link rel="prefetch" href="/assets/js/82.e8b4a8ab.js"><link rel="prefetch" href="/assets/js/83.652394c5.js"><link rel="prefetch" href="/assets/js/84.582d043e.js"><link rel="prefetch" href="/assets/js/85.9c965c7d.js"><link rel="prefetch" href="/assets/js/86.e2695d2e.js"><link rel="prefetch" href="/assets/js/87.45c26684.js"><link rel="prefetch" href="/assets/js/88.57b93a65.js"><link rel="prefetch" href="/assets/js/89.aedc79e1.js"><link rel="prefetch" href="/assets/js/9.e474432d.js"><link rel="prefetch" href="/assets/js/90.5cf46f3e.js"><link rel="prefetch" href="/assets/js/91.96fb008f.js"><link rel="prefetch" href="/assets/js/92.906b9172.js"><link rel="prefetch" href="/assets/js/93.e728b33b.js"><link rel="prefetch" href="/assets/js/94.639558ec.js"><link rel="prefetch" href="/assets/js/95.23abebdf.js"><link rel="prefetch" href="/assets/js/96.3e125d0c.js"><link rel="prefetch" href="/assets/js/97.23a3b721.js"><link rel="prefetch" href="/assets/js/98.92ba50b2.js"><link rel="prefetch" href="/assets/js/99.bf13c944.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a7a7e01f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-36818f98><div data-v-36818f98><div id="loader-wrapper" class="loading-wrapper" data-v-2c578df8 data-v-36818f98 data-v-36818f98><div class="loader-main" data-v-2c578df8><div data-v-2c578df8></div><div data-v-2c578df8></div><div data-v-2c578df8></div><div data-v-2c578df8></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-0541ff4e data-v-36818f98 data-v-36818f98><h3 class="title" style="display:none;" data-v-0541ff4e data-v-0541ff4e>天宝的博客</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-0541ff4e data-v-0541ff4e><input type="password" value="" data-v-0541ff4e> <span data-v-0541ff4e>Konck! Knock!</span> <button data-v-0541ff4e>OK</button></label> <div class="footer" style="display:none;" data-v-0541ff4e data-v-0541ff4e><span data-v-0541ff4e><i class="iconfont reco-theme" data-v-0541ff4e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-0541ff4e>vuePress-theme-reco</a></span> <span data-v-0541ff4e><i class="iconfont reco-copyright" data-v-0541ff4e></i> <a data-v-0541ff4e><span data-v-0541ff4e>天宝的博客</span>
            
          <span data-v-0541ff4e>2018 - </span>
          2021
        </a></span></div></div> <div class="hide" data-v-36818f98><header class="navbar" data-v-36818f98><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/ltbLogo.png" alt="天宝的博客" class="logo"> <span class="site-name">天宝的博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">选择主题</h4> <ul class="color-mode-options"><li class="dark">
      黑色
    </li><li class="auto active">
      自动
    </li><li class="light">
      白色
    </li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      教程
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fun/env.html" class="nav-link"><i class="iconfont undefined"></i>
  环境配置
</a></li><li class="dropdown-item"><!----> <a href="/fun/eslint.html" class="nav-link"><i class="iconfont undefined"></i>
  eslint规则
</a></li><li class="dropdown-item"><!----> <a href="/fun/scaffold.html" class="nav-link"><i class="iconfont undefined"></i>
  深入浅出前端脚手架
</a></li><li class="dropdown-item"><!----> <a href="/fun/md.html" class="nav-link"><i class="iconfont undefined"></i>
  markdown语法
</a></li><li class="dropdown-item"><!----> <a href="/static/1_1.html" class="nav-link"><i class="iconfont undefined"></i>
  全栈入门
</a></li><li class="dropdown-item"><!----> <a href="/js/1.html" class="nav-link"><i class="iconfont undefined"></i>
  JS基础
</a></li><li class="dropdown-item"><!----> <a href="/dd/1-3.html" class="nav-link"><i class="iconfont undefined"></i>
  JS高级导读
</a></li><li class="dropdown-item"><!----> <a href="/fe/vue.html" class="nav-link"><i class="iconfont undefined"></i>
  前端进阶
</a></li><li class="dropdown-item"><!----> <a href="/coding/blog.html" class="nav-link"><i class="iconfont undefined"></i>
  博客部署
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-tag"></i>
      日常总结
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/often/inherit.html" class="nav-link"><i class="iconfont undefined"></i>
  JS继承
</a></li><li class="dropdown-item"><!----> <a href="/often/js-tip.html" class="nav-link"><i class="iconfont undefined"></i>
  JS各种小知识点
</a></li><li class="dropdown-item"><!----> <a href="/wx/wechat.html" class="nav-link"><i class="iconfont undefined"></i>
  公众号开发总结
</a></li><li class="dropdown-item"><!----> <a href="/wx/mp.html" class="nav-link"><i class="iconfont undefined"></i>
  小程序原生开发
</a></li><li class="dropdown-item"><!----> <a href="/wx/uniapp.html" class="nav-link"><i class="iconfont undefined"></i>
  小程序uni-app开发
</a></li><li class="dropdown-item"><!----> <a href="/phone/optimize.html" class="nav-link"><i class="iconfont undefined"></i>
  移动端优化与踩坑
</a></li><li class="dropdown-item"><!----> <a href="/fun/opt.html" class="nav-link"><i class="iconfont undefined"></i>
  web性能优化
</a></li><li class="dropdown-item"><!----> <a href="/es6/1.html" class="nav-link"><i class="iconfont undefined"></i>
  ES6知识点
</a></li><li class="dropdown-item"><!----> <a href="/git/git.html" class="nav-link"><i class="iconfont undefined"></i>
  Git常用命令
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-other"></i>
      webpack知识
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/webpack-base.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack入门
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-note.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack随手记
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-vue.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack配置vue
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack.html" class="nav-link"><i class="iconfont undefined"></i>
  深入webpack
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-opt.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack4 拆包
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-coding"></i>
      技术积累
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/often/css.html" class="nav-link"><i class="iconfont undefined"></i>
  CSS样式封装
</a></li><li class="dropdown-item"><!----> <a href="/often/js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  JS方法封装
</a></li><li class="dropdown-item"><!----> <a href="/often/code.html" class="nav-link"><i class="iconfont undefined"></i>
  JS手写源码
</a></li><li class="dropdown-item"><!----> <a href="/skulpt/1.html" class="nav-link"><i class="iconfont undefined"></i>
  深入skulpt
</a></li><li class="dropdown-item"><!----> <a href="/scratch/1.html" class="nav-link"><i class="iconfont undefined"></i>
  深入scratch
</a></li><li class="dropdown-item"><!----> <a href="/often/ssr.html" class="nav-link"><i class="iconfont undefined"></i>
  SSR搭建部署
</a></li><li class="dropdown-item"><!----> <a href="/css/c1.html" class="nav-link"><i class="iconfont undefined"></i>
  常用特效
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      实战分享
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/share/env.html" class="nav-link"><i class="iconfont undefined"></i>
  开发环境配置参考
</a></li><li class="dropdown-item"><!----> <a href="/share/ssr.html" class="nav-link"><i class="iconfont undefined"></i>
  vue服务端渲染
</a></li><li class="dropdown-item"><!----> <a href="/share/iris.html" class="nav-link"><i class="iconfont undefined"></i>
  go+vue前后端分离实战
</a></li><li class="dropdown-item"><!----> <a href="/share/uni.html" class="nav-link"><i class="iconfont undefined"></i>
  uni-app多端开发回顾
</a></li><li class="dropdown-item"><!----> <a href="/share/koa.html" class="nav-link"><i class="iconfont undefined"></i>
  koa+vue全栈开发实战
</a></li><li class="dropdown-item"><!----> <a href="/interview/js.html" class="nav-link"><i class="iconfont undefined"></i>
  面试必备
</a></li><li class="dropdown-item"><!----> <a href="/write/write.html" class="nav-link"><i class="iconfont undefined"></i>
  笔试题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-github"></i>
      其他
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/url/fe.html" class="nav-link"><i class="iconfont undefined"></i>
  常用网址
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-36818f98></div> <aside class="sidebar" data-v-36818f98><div class="personal-info-wrapper" data-v-22ab135b><img src="/img/ltbLogo.png" alt="author-avatar" class="personal-img" data-v-22ab135b> <h3 class="name" data-v-22ab135b>
    天宝的博客
  </h3> <div class="num" data-v-22ab135b><div data-v-22ab135b><h3 data-v-22ab135b>61</h3> <h6 data-v-22ab135b>文章</h6></div> <div data-v-22ab135b><h3 data-v-22ab135b>9</h3> <h6 data-v-22ab135b>标签</h6></div></div> <hr data-v-22ab135b></div> <nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-document"></i>
      教程
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/fun/env.html" class="nav-link"><i class="iconfont undefined"></i>
  环境配置
</a></li><li class="dropdown-item"><!----> <a href="/fun/eslint.html" class="nav-link"><i class="iconfont undefined"></i>
  eslint规则
</a></li><li class="dropdown-item"><!----> <a href="/fun/scaffold.html" class="nav-link"><i class="iconfont undefined"></i>
  深入浅出前端脚手架
</a></li><li class="dropdown-item"><!----> <a href="/fun/md.html" class="nav-link"><i class="iconfont undefined"></i>
  markdown语法
</a></li><li class="dropdown-item"><!----> <a href="/static/1_1.html" class="nav-link"><i class="iconfont undefined"></i>
  全栈入门
</a></li><li class="dropdown-item"><!----> <a href="/js/1.html" class="nav-link"><i class="iconfont undefined"></i>
  JS基础
</a></li><li class="dropdown-item"><!----> <a href="/dd/1-3.html" class="nav-link"><i class="iconfont undefined"></i>
  JS高级导读
</a></li><li class="dropdown-item"><!----> <a href="/fe/vue.html" class="nav-link"><i class="iconfont undefined"></i>
  前端进阶
</a></li><li class="dropdown-item"><!----> <a href="/coding/blog.html" class="nav-link"><i class="iconfont undefined"></i>
  博客部署
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-tag"></i>
      日常总结
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/often/inherit.html" class="nav-link"><i class="iconfont undefined"></i>
  JS继承
</a></li><li class="dropdown-item"><!----> <a href="/often/js-tip.html" class="nav-link"><i class="iconfont undefined"></i>
  JS各种小知识点
</a></li><li class="dropdown-item"><!----> <a href="/wx/wechat.html" class="nav-link"><i class="iconfont undefined"></i>
  公众号开发总结
</a></li><li class="dropdown-item"><!----> <a href="/wx/mp.html" class="nav-link"><i class="iconfont undefined"></i>
  小程序原生开发
</a></li><li class="dropdown-item"><!----> <a href="/wx/uniapp.html" class="nav-link"><i class="iconfont undefined"></i>
  小程序uni-app开发
</a></li><li class="dropdown-item"><!----> <a href="/phone/optimize.html" class="nav-link"><i class="iconfont undefined"></i>
  移动端优化与踩坑
</a></li><li class="dropdown-item"><!----> <a href="/fun/opt.html" class="nav-link"><i class="iconfont undefined"></i>
  web性能优化
</a></li><li class="dropdown-item"><!----> <a href="/es6/1.html" class="nav-link"><i class="iconfont undefined"></i>
  ES6知识点
</a></li><li class="dropdown-item"><!----> <a href="/git/git.html" class="nav-link"><i class="iconfont undefined"></i>
  Git常用命令
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-other"></i>
      webpack知识
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/webpack/webpack-base.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack入门
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-note.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack随手记
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-vue.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack配置vue
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack.html" class="nav-link"><i class="iconfont undefined"></i>
  深入webpack
</a></li><li class="dropdown-item"><!----> <a href="/webpack/webpack-opt.html" class="nav-link"><i class="iconfont undefined"></i>
  webpack4 拆包
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-coding"></i>
      技术积累
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/often/css.html" class="nav-link"><i class="iconfont undefined"></i>
  CSS样式封装
</a></li><li class="dropdown-item"><!----> <a href="/often/js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active"><i class="iconfont undefined"></i>
  JS方法封装
</a></li><li class="dropdown-item"><!----> <a href="/often/code.html" class="nav-link"><i class="iconfont undefined"></i>
  JS手写源码
</a></li><li class="dropdown-item"><!----> <a href="/skulpt/1.html" class="nav-link"><i class="iconfont undefined"></i>
  深入skulpt
</a></li><li class="dropdown-item"><!----> <a href="/scratch/1.html" class="nav-link"><i class="iconfont undefined"></i>
  深入scratch
</a></li><li class="dropdown-item"><!----> <a href="/often/ssr.html" class="nav-link"><i class="iconfont undefined"></i>
  SSR搭建部署
</a></li><li class="dropdown-item"><!----> <a href="/css/c1.html" class="nav-link"><i class="iconfont undefined"></i>
  常用特效
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      实战分享
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/share/env.html" class="nav-link"><i class="iconfont undefined"></i>
  开发环境配置参考
</a></li><li class="dropdown-item"><!----> <a href="/share/ssr.html" class="nav-link"><i class="iconfont undefined"></i>
  vue服务端渲染
</a></li><li class="dropdown-item"><!----> <a href="/share/iris.html" class="nav-link"><i class="iconfont undefined"></i>
  go+vue前后端分离实战
</a></li><li class="dropdown-item"><!----> <a href="/share/uni.html" class="nav-link"><i class="iconfont undefined"></i>
  uni-app多端开发回顾
</a></li><li class="dropdown-item"><!----> <a href="/share/koa.html" class="nav-link"><i class="iconfont undefined"></i>
  koa+vue全栈开发实战
</a></li><li class="dropdown-item"><!----> <a href="/interview/js.html" class="nav-link"><i class="iconfont undefined"></i>
  面试必备
</a></li><li class="dropdown-item"><!----> <a href="/write/write.html" class="nav-link"><i class="iconfont undefined"></i>
  笔试题
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-github"></i>
      其他
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/url/fe.html" class="nav-link"><i class="iconfont undefined"></i>
  常用网址
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>常用方法封装</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/often/js.html#_1、全屏功能" class="sidebar-link">1、全屏功能</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_2、检测pc端和移动端设备" class="sidebar-link">2、检测PC端和移动端设备</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_3、dom片段生成图片" class="sidebar-link">3、dom片段生成图片</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_4、url生成二维码" class="sidebar-link">4、url生成二维码</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_5、时间戳转换成日期" class="sidebar-link">5、时间戳转换成日期</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_6、判断是否是微信浏览器" class="sidebar-link">6、判断是否是微信浏览器</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_7、判断ios环境" class="sidebar-link">7、判断IOS环境</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_8、rem布局" class="sidebar-link">8、rem布局</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_9、绑定虚拟键盘" class="sidebar-link">9、绑定虚拟键盘</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_10、录屏" class="sidebar-link">10、录屏</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_11、图片预加载" class="sidebar-link">11、图片预加载</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_12、区分input框中英文字符长度" class="sidebar-link">12、区分input框中英文字符长度</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_13、vue2-0路由切换后页面滚动位置不变bug" class="sidebar-link">13、vue2.0路由切换后页面滚动位置不变BUG</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_14、九宫格抽奖" class="sidebar-link">14、九宫格抽奖</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_15、时间倒计时" class="sidebar-link">15、时间倒计时</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/often/js.html#_16、移动端关闭软键盘导致页面不下落" class="sidebar-link">16、移动端关闭软键盘导致页面不下落</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-0541ff4e data-v-36818f98><h3 class="title" style="display:none;" data-v-0541ff4e data-v-0541ff4e>常用方法封装</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-0541ff4e data-v-0541ff4e><input type="password" value="" data-v-0541ff4e> <span data-v-0541ff4e>Konck! Knock!</span> <button data-v-0541ff4e>OK</button></label> <div class="footer" style="display:none;" data-v-0541ff4e data-v-0541ff4e><span data-v-0541ff4e><i class="iconfont reco-theme" data-v-0541ff4e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-0541ff4e>vuePress-theme-reco</a></span> <span data-v-0541ff4e><i class="iconfont reco-copyright" data-v-0541ff4e></i> <a data-v-0541ff4e><span data-v-0541ff4e>天宝的博客</span>
            
          <span data-v-0541ff4e>2018 - </span>
          2021
        </a></span></div></div> <div data-v-36818f98><main class="page"><div class="page-title" style="display:none;"><h1>常用方法封装</h1> <hr> <div data-v-4feec9bb><i class="iconfont reco-account" data-v-4feec9bb><span data-v-4feec9bb>天宝的博客</span></i> <!----> <i class="iconfont reco-eye" data-v-4feec9bb><span id="/often/js.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-4feec9bb><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="iconfont reco-tag tags" data-v-4feec9bb><span class="tag-item" data-v-4feec9bb>js</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="_1、全屏功能"><a href="#_1、全屏功能" class="header-anchor">#</a> 1、全屏功能</h2> <p>以Vue代码为例。<br></p> <div class="language-js extra-class"><pre class="language-js"><code>dataFull<span class="token operator">:</span> 初始值，判断当前页面是否是全屏状态，默认<span class="token boolean">false</span>
show<span class="token operator">:</span> 控制全屏图标切换显示

<span class="token comment">// 切换全屏</span>
<span class="token function">fullORno</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>dataFull <span class="token operator">==</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">exitFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataFull <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">launchFullscreen</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dataFull <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>show <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 进入全屏</span>
<span class="token function">launchFullscreen</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>requestFullscreen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">requestFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>mozRequestFullScreen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">mozRequestFullScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>webkitRequestFullscreen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">webkitRequestFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>element<span class="token punctuation">.</span>msRequestFullscreen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        element<span class="token punctuation">.</span><span class="token function">msRequestFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
 <span class="token comment">// 退出全屏</span>
<span class="token function">exitFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>exitFullscreen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">exitFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>mozCancelFullScreen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">mozCancelFullScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>document<span class="token punctuation">.</span>webkitExitFullscreen<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        document<span class="token punctuation">.</span><span class="token function">webkitExitFullscreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2、检测pc端和移动端设备"><a href="#_2、检测pc端和移动端设备" class="header-anchor">#</a> 2、检测PC端和移动端设备</h2> <p>例子：如果条件成立是移动端，跳转到百度，可根据业务需求进行不同操作。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        window<span class="token punctuation">.</span>location <span class="token operator">=</span> b<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>
  navigator<span class="token punctuation">.</span>userAgent <span class="token operator">||</span> navigator<span class="token punctuation">.</span>vendor <span class="token operator">||</span> window<span class="token punctuation">.</span>opera<span class="token punctuation">,</span>
  <span class="token string">&quot;https://www.baidu.com&quot;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_3、dom片段生成图片"><a href="#_3、dom片段生成图片" class="header-anchor">#</a> 3、dom片段生成图片</h2> <div class="custom-block tip"><p class="custom-block-title">业务场景：</p> <p>海报等活动业务，指定一块区域或者整个页面获取信息后，在移动端可长按保存图片，PC端可以右键保存图片到本地。</p></div> <ul><li>cdn链接：https://cdn.bootcss.com/html2canvas/0.5.0-beta4/html2canvas.min.js</li> <li>html2canvas.js：可将 htmldom 转为 canvas 元素<br></li> <li>canvasAPI：toDataUrl() 可将 canvas 转为 base64 格式<br></li> <li>base64转成file，通过upload接口生成url<br></li></ul> <p>1、设备像素比 (简称 dpr) 定义了物理像素和设备独立像素的对应关系，它的值可以按如下的公式的得到：设备像素比 = 物理像素 / 设备独立像素
所以我们可以先获取设备像素比，然后根据比例创建尺寸更大的canvas，如二倍屏就是二倍，三倍屏就是三倍...<br>
2、图片不能使用background，必须用img标签，具体原因不清楚，亲测。。。（应该是插件本身原因）<br>
3、跨域图片绘制不出来<br>
4、box-shadow在tocanvas时会丢失<br></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
* 法一
*/</span>
<span class="token comment">// 要生成图片的dom片段</span>
<span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'page'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> w <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'width'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> h <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">'height'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 宽高放大两倍</span>
canvas<span class="token punctuation">.</span>width  <span class="token operator">=</span> w <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>height <span class="token operator">=</span> h <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> w <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
canvas<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> h <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> context <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">&quot;2d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//然后将画布缩放，将图像放大两倍画到画布上</span>
context<span class="token punctuation">.</span><span class="token function">scale</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">html2canvas</span><span class="token punctuation">(</span>div<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    canvas<span class="token operator">:</span> canvas<span class="token punctuation">,</span>
    <span class="token function-variable function">onrendered</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">canvas</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//这里返回了一个canvas 定位一下</span>
        <span class="token function">$</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token string">'position'</span><span class="token operator">:</span><span class="token string">'absolute'</span><span class="token punctuation">,</span>
            <span class="token string">'top'</span><span class="token operator">:</span><span class="token string">'0'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>     
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">;</span>
        _this<span class="token punctuation">.</span>isShowCanvas <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token comment">// 将canvas.toDataURL()生成的地址赋给img元素</span>
            <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'#canvasImg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">'src'</span><span class="token punctuation">,</span>canvas<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token function">$</span><span class="token punctuation">(</span>canvas<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*-----------------------------------------------------------*/</span>
<span class="token comment">/*
* 法二（随着插件的更新，调用方式随之改变，看版本）
*/</span>
<span class="token comment">// 要生成图片的dom片段</span>
<span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByClassName</span><span class="token punctuation">(</span><span class="token string">'page'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.mask'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'100%'</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span>style<span class="token punctuation">.</span>zIndex <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;canvas&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// canvas可提前创建，可动态创建</span>
<span class="token keyword">const</span> scaleBy <span class="token operator">=</span> <span class="token constant">DPR</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取像素比</span>

<span class="token comment">// 设定 canvas 元素属性宽高为 DOM 节点宽高 * 像素比</span>
<span class="token keyword">const</span> defaultCanvasOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
  canvas<span class="token operator">:</span> canvas <span class="token operator">||</span> <span class="token punctuation">(</span>canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  removeContainer<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  allowTaint<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  imageTimeout<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  async<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function">ignoreElements</span><span class="token punctuation">(</span><span class="token parameter">element</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> id <span class="token operator">=</span> element<span class="token punctuation">.</span>id
    <span class="token keyword">if</span> <span class="token punctuation">(</span> id<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'slide'</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span> id<span class="token operator">===</span> <span class="token string">'slide12'</span> <span class="token operator">||</span> id <span class="token operator">===</span> <span class="token string">'loading-page'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
        <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> canvas1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">html2canvas</span><span class="token punctuation">(</span>div<span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token operator">...</span>defaultCanvasOptions<span class="token punctuation">,</span> scale<span class="token operator">:</span> scaleBy<span class="token punctuation">}</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>div<span class="token punctuation">)</span>
<span class="token keyword">let</span> img <span class="token operator">=</span> <span class="token function">getImage</span><span class="token punctuation">(</span><span class="token string">'thumbnail-img'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">img</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#share-page .snapshot'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> canvas1<span class="token punctuation">.</span><span class="token function">toDataURL</span><span class="token punctuation">(</span><span class="token string">'image/png'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>5、base64转file，使用new FIle会有兼容性支持问题，可以使用toBlob</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">dataURLtoBlob</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> mimeString <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">';'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token keyword">var</span> byteString <span class="token operator">=</span> <span class="token function">atob</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> ab <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayBuffer</span><span class="token punctuation">(</span>byteString<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
  <span class="token keyword">var</span> ia <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Uint8Array</span><span class="token punctuation">(</span>ab<span class="token punctuation">)</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> byteString<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ia<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> byteString<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> bb <span class="token operator">=</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>BlobBuilder <span class="token operator">||</span> window<span class="token punctuation">.</span>WebKitBlobBuilder <span class="token operator">||</span> window<span class="token punctuation">.</span>MozBlobBuilder<span class="token punctuation">)</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>bb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    bb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>BlobBuilder <span class="token operator">||</span> window<span class="token punctuation">.</span>WebKitBlobBuilder <span class="token operator">||</span> window<span class="token punctuation">.</span>MozBlobBuilder<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    bb<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>ab<span class="token punctuation">)</span>
    <span class="token keyword">return</span> bb<span class="token punctuation">.</span><span class="token function">getBlob</span><span class="token punctuation">(</span>mimeString<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    bb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Blob</span><span class="token punctuation">(</span><span class="token punctuation">[</span>ab<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string">'type'</span><span class="token operator">:</span> <span class="token punctuation">(</span>mimeString<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> bb
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_4、url生成二维码"><a href="#_4、url生成二维码" class="header-anchor">#</a> 4、url生成二维码</h2> <p>vue为例</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> QRCode <span class="token keyword">from</span> <span class="token string">'qrcode'</span><span class="token punctuation">;</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>QRCode <span class="token operator">=</span> QRCode<span class="token punctuation">;</span> <span class="token comment">// 建议挂载到原型上，供他组件调用</span>
<span class="token comment">// 生成二维码</span>
<span class="token function">useqrcode</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>QRCode<span class="token punctuation">.</span><span class="token function">toCanvas</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'success!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_5、时间戳转换成日期"><a href="#_5、时间戳转换成日期" class="header-anchor">#</a> 5、时间戳转换成日期</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 方法一</span>
<span class="token keyword">function</span> <span class="token function">timeData</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> year <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> month <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">9</span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">0</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>d<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>d<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> day <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">0</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>d<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>d<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> hour <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token number">10</span> <span class="token operator">?</span> <span class="token string">'0'</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">''</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> minutes <span class="token operator">=</span> d<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token number">10</span> <span class="token operator">?</span> <span class="token string">'0'</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">''</span> <span class="token operator">+</span> d<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span>  year<span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> month <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> day <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> hour <span class="token operator">+</span> <span class="token string">':'</span> <span class="token operator">+</span> minutes<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 方法二</span>
<span class="token keyword">function</span> <span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token parameter">date<span class="token punctuation">,</span> format</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  format <span class="token operator">=</span> format <span class="token operator">||</span> <span class="token string">'yyyy-MM-dd hh:mm:ss'</span><span class="token punctuation">;</span>
  date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>date<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;MM&quot;</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//month</span>
    <span class="token string">&quot;dd&quot;</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//day</span>
    <span class="token string">&quot;hh&quot;</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//hour</span>
    <span class="token string">&quot;mm&quot;</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//minute</span>
    <span class="token string">&quot;ss&quot;</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//second</span>
    <span class="token string">&quot;qq&quot;</span><span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//quarter</span>
    <span class="token string">&quot;S&quot;</span><span class="token operator">:</span> date<span class="token punctuation">.</span><span class="token function">getMilliseconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//millisecond</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// RegExp.$1是RegExp的一个属性,指的是与正则表达式匹配的第一个 子匹配(以括号为标志)字符串</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(y+)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">)</span> format <span class="token operator">=</span> format<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$<span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">-</span> RegExp<span class="token punctuation">.</span>$<span class="token number">1.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//获取年份</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token keyword">in</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">&quot;(&quot;</span> <span class="token operator">+</span> k <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>format<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      format <span class="token operator">=</span> format<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>RegExp<span class="token punctuation">.</span>$<span class="token number">1</span><span class="token punctuation">,</span> RegExp<span class="token punctuation">.</span>$<span class="token number">1.</span>length <span class="token operator">===</span> <span class="token number">1</span> <span class="token operator">?</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token string">'00'</span> <span class="token operator">+</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span> <span class="token operator">+</span> o<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> format<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> time <span class="token operator">=</span> <span class="token number">1615517559258</span>

<span class="token function">timeData</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span>
<span class="token function">formatDate</span><span class="token punctuation">(</span>time<span class="token punctuation">,</span> <span class="token string">&quot;hh:mm&quot;</span><span class="token punctuation">)</span> <span class="token comment">// hh:mm格式</span>
</code></pre></div><h2 id="_6、判断是否是微信浏览器"><a href="#_6、判断是否是微信浏览器" class="header-anchor">#</a> 6、判断是否是微信浏览器</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isWxUa</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ua <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ua<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">MicroMessenger</span><span class="token regex-delimiter">/</span><span class="token regex-flags">i</span></span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'micromessenger'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_7、判断ios环境"><a href="#_7、判断ios环境" class="header-anchor">#</a> 7、判断IOS环境</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isIOS</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> isIphone <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'iPhone'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> isIpad <span class="token operator">=</span> navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'iPad'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> isIphone <span class="token operator">||</span> isIpad<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_8、rem布局"><a href="#_8、rem布局" class="header-anchor">#</a> 8、rem布局</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//封装设置rem的方法</span>
<span class="token keyword">function</span> <span class="token function">setREM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">//建议 设置UI设计图宽度尺寸 （以1440为例）</span>
	<span class="token keyword">const</span> whdef <span class="token operator">=</span> <span class="token number">100</span><span class="token operator">/</span><span class="token number">1440</span><span class="token punctuation">;</span>
	<span class="token comment">//获取浏览器可见区域宽度</span>
	<span class="token keyword">const</span> wW <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth <span class="token operator">||</span> document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>
	<span class="token comment">//以默认比例值乘以当前窗口宽度,得到该宽度下的相应FONT-SIZE值</span>
	<span class="token keyword">const</span> rem <span class="token operator">=</span> wW <span class="token operator">*</span> whdef<span class="token punctuation">;</span>
	<span class="token comment">//设置字体值  (当屏幕宽度为1440时，font-size = 100px 即1rem = 100px)</span>
	document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> rem <span class="token operator">+</span> <span class="token string">'px'</span>
<span class="token punctuation">}</span>
<span class="token comment">//先首次调用</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">setREM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>	
<span class="token comment">//设置监听浏览器窗口变化函数  动态改变font-size的值</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onresize</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token function">setREM</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9、绑定虚拟键盘"><a href="#_9、绑定虚拟键盘" class="header-anchor">#</a> 9、绑定虚拟键盘</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
 * 给元素添加事件（用来触发键盘事件）
 * el模拟事件的触发元素，evtType事件类型，keycode对应的键盘事件的键值,key对应事件所触发的键名,
 */</span>
<span class="token keyword">function</span> <span class="token function">createKeyEvent</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span> evtType<span class="token punctuation">,</span> keyCode <span class="token punctuation">,</span>key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> doc <span class="token operator">=</span> el<span class="token punctuation">.</span>ownerDocument<span class="token punctuation">,</span>
        win <span class="token operator">=</span> doc<span class="token punctuation">.</span>defaultView <span class="token operator">||</span> doc<span class="token punctuation">.</span>parentWindow<span class="token punctuation">,</span>
        evtObj<span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>createEvent<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>win<span class="token punctuation">.</span>KeyEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            evtObj <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createEvent</span><span class="token punctuation">(</span><span class="token string">'KeyEvents'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            evtObj<span class="token punctuation">.</span><span class="token function">initKeyEvent</span><span class="token punctuation">(</span> evtType<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> win<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> keyCode<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            evtObj <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createEvent</span><span class="token punctuation">(</span><span class="token string">'UIEvents'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>evtObj<span class="token punctuation">,</span> <span class="token string">'keyCode'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token function-variable function">get</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyCodeVal<span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>evtObj<span class="token punctuation">,</span> <span class="token string">'which'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
                <span class="token function-variable function">get</span> <span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>keyCodeVal<span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            evtObj<span class="token punctuation">.</span><span class="token function">initUIEvent</span><span class="token punctuation">(</span> evtType<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> win<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
            evtObj<span class="token punctuation">.</span>key <span class="token operator">=</span> key<span class="token punctuation">;</span>
            evtObj<span class="token punctuation">.</span>keyCodeVal <span class="token operator">=</span> keyCode<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token parameter">evtObj<span class="token punctuation">.</span>keyCode <span class="token operator">!==</span> keyCode</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;keyCode &quot;</span> <span class="token operator">+</span> evtObj<span class="token punctuation">.</span>keyCode <span class="token operator">+</span> <span class="token string">&quot; 和 (&quot;</span> <span class="token operator">+</span> evtObj<span class="token punctuation">.</span>which <span class="token operator">+</span> <span class="token string">&quot;) 不匹配&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        el<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span>evtObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>createEventObject<span class="token punctuation">)</span><span class="token punctuation">{</span>
        evtObj <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">createEventObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        evtObj<span class="token punctuation">.</span>keyCode <span class="token operator">=</span> keyCode<span class="token punctuation">;</span>
        el<span class="token punctuation">.</span><span class="token function">fireEvent</span><span class="token punctuation">(</span><span class="token string">'on'</span> <span class="token operator">+</span> evtType<span class="token punctuation">,</span> evtObj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">/*
 * 给数组元素批量添加事件（用来触发键盘事件）
 */</span>
<span class="token keyword">function</span> <span class="token function">batchAddEvent</span><span class="token punctuation">(</span><span class="token parameter">el<span class="token punctuation">,</span>list</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    list <span class="token operator">=</span> list <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>len<span class="token operator">=</span>list<span class="token punctuation">.</span>length<span class="token punctuation">;</span>i<span class="token operator">&lt;</span>len<span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// PC端绑定点击事件触发键盘事件</span>
        <span class="token comment">// list[i].obj.onclick = function () {</span>
        <span class="token comment">//     createKeyEvent(el, 'keydown', list[i].keyCode , list[i].key);</span>
        <span class="token comment">// }</span>
        <span class="token comment">// 移动端需要按下抬起两个动作 touchstart触发keydpown  touchend触发keyup</span>
        list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>obj<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;touchstart&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>obj<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token string">&quot;active&quot;</span><span class="token punctuation">)</span>
            <span class="token function">createKeyEvent</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token string">'keydown'</span><span class="token punctuation">,</span> list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>keyCode <span class="token punctuation">,</span> list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>obj<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;touchend&quot;</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>obj<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string">&quot;active&quot;</span><span class="token punctuation">)</span>
            <span class="token function">createKeyEvent</span><span class="token punctuation">(</span>el<span class="token punctuation">,</span> <span class="token string">'keyup'</span><span class="token punctuation">,</span> list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>keyCode <span class="token punctuation">,</span> list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">bindkeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> space <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#space'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> up <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#up'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> down <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#down'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> left <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#left'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> right <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#right'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 需要模拟键盘操控的区域</span>
    <span class="token keyword">const</span> canvas <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'ocanvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 如果你需要添加事件的元素比较多。可以使用index.js里面的 batchAddEvent方法 批量绑定</span>
    <span class="token keyword">let</span> aele <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            obj<span class="token operator">:</span> space<span class="token punctuation">,</span>
            keyCode<span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token string">&quot; &quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            obj<span class="token operator">:</span> down<span class="token punctuation">,</span>
            keyCode<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token string">&quot;ArrowDown&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            obj<span class="token operator">:</span> left<span class="token punctuation">,</span>
            keyCode<span class="token operator">:</span> <span class="token number">37</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token string">&quot;ArrowLeft&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            obj<span class="token operator">:</span> right<span class="token punctuation">,</span>
            keyCode<span class="token operator">:</span> <span class="token number">39</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token string">&quot;ArrowRight&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            obj<span class="token operator">:</span> up<span class="token punctuation">,</span>
            keyCode<span class="token operator">:</span> <span class="token number">38</span><span class="token punctuation">,</span>
            key<span class="token operator">:</span> <span class="token string">&quot;ArrowUp&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token function">batchAddEvent</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span>aele<span class="token punctuation">)</span>

    <span class="token comment">// 监听事件（移动端举例）</span>
    canvas<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchmove'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchstart'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    canvas<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchend'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keydown'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'keyup'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_10、录屏"><a href="#_10、录屏" class="header-anchor">#</a> 10、录屏</h2> <div class="custom-block tip"><p class="custom-block-title">参考链接：</p> <ul><li>https://www.javascriptcn.com/read-34705.html</li> <li>https://www.webrtc-experiment.com/RecordRTC/Canvas-Recording/</li></ul></div> <h4 id="原生js实现录屏-复制后可直接在浏览器运行"><a href="#原生js实现录屏-复制后可直接在浏览器运行" class="header-anchor">#</a> <font color="#016ab8">原生JS实现录屏，复制后可直接在浏览器运行</font></h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
		    <span class="token selector">#btn</span> <span class="token punctuation">{</span>
		    	<span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
		    	<span class="token property">width</span><span class="token punctuation">:</span> 150px<span class="token punctuation">;</span>
		    	<span class="token property">left</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
		    	<span class="token property">top</span><span class="token punctuation">:</span> 500px<span class="token punctuation">;</span>
		    	<span class="token property">margin</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
		    <span class="token punctuation">}</span>
		    <span class="token selector">#div</span> <span class="token punctuation">{</span>
		    	<span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
		    	<span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
		    	<span class="token property">border</span><span class="token punctuation">:</span> 5px solid gray<span class="token punctuation">;</span>
		    	<span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span> 
		    	<span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span> 
		    	<span class="token property">margin</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
		    	<span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span> 
		    	<span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
		    <span class="token punctuation">}</span>
		    <span class="token selector">#div #share</span> <span class="token punctuation">{</span>
		    	<span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
		    	<span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
		    	<span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
		    	<span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
		    	<span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
		    	<span class="token property">background</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
		    	<span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
		    <span class="token punctuation">}</span>
		    <span class="token selector">#parentVideo</span> <span class="token punctuation">{</span>
    	    	<span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
			    <span class="token property">top</span><span class="token punctuation">:</span> 0%<span class="token punctuation">;</span>
			    <span class="token property">right</span><span class="token punctuation">:</span> 6%<span class="token punctuation">;</span>
		        <span class="token property">width</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span> 
		    	<span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
		    <span class="token punctuation">}</span>
		    <span class="token selector">#parentVideo&gt;video</span><span class="token punctuation">{</span>
	        	<span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
	        <span class="token punctuation">}</span>
	        <span class="token selector">#audio</span> <span class="token punctuation">{</span>
	        	<span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
	        	<span class="token property">top</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span>
	        <span class="token punctuation">}</span>
		</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn-start<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>开始录制<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn-stop<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>结束录制<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>parentVideo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>播放区域<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">controls</span> <span class="token attr-name">autoplay</span> <span class="token attr-name">playsinline</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>video<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>div<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
			<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>屏幕录制区域<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请开始你的表演<span class="token punctuation">&quot;</span></span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token style language-css"><span class="token property">width</span><span class="token punctuation">:</span> 80%<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>share<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
		    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>等待录音中。。。。。请稍等。。。。。。。红色背景消失开始录制<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
		    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>canvas<span class="token punctuation">&quot;</span></span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token style language-css"><span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span> <span class="token property">top</span><span class="token punctuation">:</span>-99999999px<span class="token punctuation">;</span> <span class="token property">left</span><span class="token punctuation">:</span>-9999999999px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
		
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://www.webrtc-experiment.com/RecordRTC.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://webrtc.github.io/adapter/adapter-latest.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://www.webrtc-experiment.com/html2canvas.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
		
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
			<span class="token keyword">var</span> elementToRecord <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">var</span> canvas2d <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'canvas'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			canvas2d<span class="token punctuation">.</span>width <span class="token operator">=</span> elementToRecord<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span>
			canvas2d<span class="token punctuation">.</span>height <span class="token operator">=</span> elementToRecord<span class="token punctuation">.</span>clientHeight<span class="token punctuation">;</span>
			<span class="token keyword">var</span> context <span class="token operator">=</span> canvas2d<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token string">'2d'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">var</span> canvasStream <span class="token operator">=</span> canvas<span class="token punctuation">.</span><span class="token function">captureStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">var</span> finalStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MediaStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">var</span> audioStream <span class="token operator">=</span> <span class="token keyword">null</span>
			<span class="token keyword">var</span> isStoppedRecording <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
			<span class="token keyword">var</span> recorderVideo <span class="token operator">=</span> <span class="token keyword">null</span>
			<span class="token keyword">var</span> isRecorder <span class="token operator">=</span> <span class="token boolean">false</span> <span class="token comment">// 控制是否需要录音</span>
			
			document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn-start'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'video'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
				document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn-stop'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>disabled <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
				isStoppedRecording <span class="token operator">=</span> <span class="token boolean">false</span>
				isRecorder <span class="token operator">=</span> <span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'视频需要录音吗'</span><span class="token punctuation">)</span>
			    isRecorder <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token function">startAudio</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'share'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">startVideo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span><span class="token punctuation">;</span>
			
			document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn-stop'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			    isStoppedRecording <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
			    <span class="token function">stopAudioOrVideo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
            
            <span class="token comment">// 生成canvas视频</span>
			<span class="token keyword">function</span> <span class="token function">looper</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span>isStoppedRecording<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		            <span class="token keyword">return</span><span class="token punctuation">;</span>
		        <span class="token punctuation">}</span>
			    <span class="token function">html2canvas</span><span class="token punctuation">(</span>elementToRecord<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">canvas</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			        context<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvas2d<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas2d<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
			        context<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>canvas<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> canvas2d<span class="token punctuation">.</span>width<span class="token punctuation">,</span> canvas2d<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span>
			    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span>looper<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token comment">// 开始录屏方法</span>
			<span class="token keyword">function</span> <span class="token function">startVideo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				recorderVideo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RecordRTC</span><span class="token punctuation">(</span>canvas2d<span class="token punctuation">,</span> <span class="token punctuation">{</span>	<span class="token comment">// 录制canvas生成视频</span>
				    type<span class="token operator">:</span> <span class="token string">'canvas'</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				recorderVideo<span class="token punctuation">.</span><span class="token function">startRecording</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			    <span class="token function">setTimeout</span><span class="token punctuation">(</span>looper<span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
			
			<span class="token comment">// 开始录音方法</span>
			<span class="token keyword">function</span> <span class="token function">startAudio</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				navigator<span class="token punctuation">.</span>mediaDevices<span class="token punctuation">.</span><span class="token function">getUserMedia</span><span class="token punctuation">(</span><span class="token punctuation">{</span> audio<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>successAudioCallback<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			<span class="token comment">// 录音设备准备成功后回调</span>
			<span class="token keyword">function</span> <span class="token function">successAudioCallback</span><span class="token punctuation">(</span><span class="token parameter">audioStream</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token function">getTracks</span><span class="token punctuation">(</span>audioStream<span class="token punctuation">,</span> <span class="token string">'audio'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">track</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					finalStream<span class="token punctuation">.</span><span class="token function">addTrack</span><span class="token punctuation">(</span>track<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token function">getTracks</span><span class="token punctuation">(</span>canvasStream<span class="token punctuation">,</span> <span class="token string">'video'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">track</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					finalStream<span class="token punctuation">.</span><span class="token function">addTrack</span><span class="token punctuation">(</span>track<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				
				recorderVideo <span class="token operator">=</span> <span class="token function">RecordRTC</span><span class="token punctuation">(</span>finalStream<span class="token punctuation">,</span> <span class="token punctuation">{</span>
					type<span class="token operator">:</span> <span class="token string">'video'</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				recorderVideo<span class="token punctuation">.</span><span class="token function">startRecording</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			    <span class="token function">setTimeout</span><span class="token punctuation">(</span>looper<span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">)</span>
			    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'可以开始录音了'</span><span class="token punctuation">)</span>
			    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'share'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
			<span class="token punctuation">}</span>
			<span class="token comment">// 结束录音录屏方法</span>
			<span class="token keyword">function</span> <span class="token function">stopAudioOrVideo</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				recorderVideo<span class="token punctuation">.</span><span class="token function">stopRecording</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">audioURL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	                document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'video'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>src <span class="token operator">=</span> audioURL<span class="token punctuation">;</span>
	                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>audioURL<span class="token punctuation">)</span>
	                recorderVideo<span class="token punctuation">.</span><span class="token function">getDataURL</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">dataURL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	                	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>dataURL<span class="token punctuation">)</span>
	                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	                <span class="token keyword">var</span> recordedBlob <span class="token operator">=</span> recorderVideo<span class="token punctuation">.</span><span class="token function">getBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>recordedBlob<span class="token punctuation">)</span>
	                <span class="token keyword">var</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;audioData&quot;</span><span class="token punctuation">,</span> recordedBlob<span class="token punctuation">)</span><span class="token punctuation">;</span>
					console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fd<span class="token punctuation">)</span>
	                <span class="token comment">// document.getElementById('video').src = URL.createObjectURL(recordedBlob)</span>
	                <span class="token comment">// canvasStream.stop();</span>
					<span class="token comment">// audioStream.stop();</span>
					recorderVideo<span class="token punctuation">.</span><span class="token function">clearRecordedData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token comment">// 上传到后台，根据业务自行修改</span>
			<span class="token keyword">function</span> <span class="token function">upLoad</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token keyword">var</span> fd <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				fd<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;audioData&quot;</span><span class="token punctuation">,</span> blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
				$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
				    url<span class="token operator">:</span> <span class="token string">'/upload'</span><span class="token punctuation">,</span>
				    type<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
				    cache<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
				    data<span class="token operator">:</span> fd<span class="token punctuation">,</span>
				    processData<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
				    contentType<span class="token operator">:</span> <span class="token boolean">false</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span>
			<span class="token punctuation">}</span>
			
		</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_11、图片预加载"><a href="#_11、图片预加载" class="header-anchor">#</a> 11、图片预加载</h2> <div class="language-js extra-class"><pre class="language-js"><code>imgSrc<span class="token operator">:</span> <span class="token punctuation">[</span>
  <span class="token string">'static/homepage/map/s1bg.jpg'</span><span class="token punctuation">,</span>
  <span class="token string">'static/homepage/map/s1Blur.jpg'</span><span class="token punctuation">,</span>
  <span class="token string">'static/courseList/imgs/returnMapHover.png'</span><span class="token punctuation">,</span>
  <span class="token string">'static/courseList/imgs/returnCourseHover.png'</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 地图背景</span>

<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">preloadImg</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>imgSrc<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">preloadImg</span><span class="token punctuation">(</span><span class="token parameter">arr</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 预加载</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>imgWrap<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>imgWrap<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>src <span class="token operator">=</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> timers <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>imgWrap<span class="token punctuation">[</span>arr<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>complete<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// to do sth</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>timers<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="_12、区分input框中英文字符长度"><a href="#_12、区分input框中英文字符长度" class="header-anchor">#</a> 12、区分input框中英文字符长度</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">validTxtLength</span><span class="token punctuation">(</span><span class="token parameter">input</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i<span class="token punctuation">;</span>
    <span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> input<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   
        <span class="token comment">// 英文一个字符长度，中文两个字符长度</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>input<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   
            sum <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>   
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>   
            sum <span class="token operator">+=</span> <span class="token number">2</span><span class="token punctuation">;</span>   
        <span class="token punctuation">}</span>   
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> sum<span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_13、vue2-0路由切换后页面滚动位置不变bug"><a href="#_13、vue2-0路由切换后页面滚动位置不变bug" class="header-anchor">#</a> 13、vue2.0路由切换后页面滚动位置不变BUG</h2> <p>解决办法很简单，如下，直接监测watch路由变化，然后将body的滚动距离scrollTop赋值为0。</p> <div class="language-js extra-class"><pre class="language-js"><code>watch<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token string">'$route'</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span><span class="token keyword">from</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> <span class="token string">'0'</span><span class="token punctuation">;</span>    <span class="token comment">// 这句比较重要（微信端可以这么写）</span>
        document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// pc端这么写</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_14、九宫格抽奖"><a href="#_14、九宫格抽奖" class="header-anchor">#</a> 14、九宫格抽奖</h2> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>gameBox<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bg2<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-show</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lampShow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>start<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>move<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>（{{ number_of_draws }}次）<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span>
        <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(item, i) in list<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>i<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[<span class="token punctuation">'</span>item<span class="token punctuation">'</span> + (i + 1), { active: index == i }]<span class="token punctuation">&quot;</span></span>
      <span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>img1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">:src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.image<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>{{ item.prize_name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
    
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      list<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 奖品列表</span>
      index<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 当前转动到哪个位置，第一次起点位置0,对应页面item1位置</span>
      count<span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token comment">// 总共有多少个位置</span>
      times<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 转动跑格子次数,</span>
      cycle<span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token comment">// 转动基本次数：即至少需要转动多少次再进入抽奖环节</span>
      speed<span class="token operator">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token comment">// 初始转动速度</span>
      lampShow<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//开始抽奖，灯光闪烁</span>
      timer<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 转动定时器</span>
      prize<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 中奖位置，接口返回</span>
      number_of_draws<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 用户剩余抽奖次数</span>
      prize_data<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getLotteryGoods</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取奖品列表</span>
    <span class="token function">getLotteryGoods</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// api.getLotteryGoods(param).then(res =&gt; {</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          number<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          prize_name<span class="token operator">:</span> <span class="token string">&quot;积分&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          number<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
          prize_name<span class="token operator">:</span> <span class="token string">&quot;优惠券&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
          number<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
          prize_name<span class="token operator">:</span> <span class="token string">&quot;积分&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          number<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
          prize_name<span class="token operator">:</span> <span class="token string">&quot;红包&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
          number<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
          prize_name<span class="token operator">:</span> <span class="token string">&quot;优惠券&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
          number<span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>
          prize_name<span class="token operator">:</span> <span class="token string">&quot;积分&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
          number<span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
          prize_name<span class="token operator">:</span> <span class="token string">&quot;红包&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          id<span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
          number<span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
          prize_name<span class="token operator">:</span> <span class="token string">&quot;优惠券&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>number_of_draws <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
      <span class="token comment">// })</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 点击抽奖，获取中奖位置信息</span>
    <span class="token function">getUserLottery</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// api.getUserLottery(param).then(res =&gt; {</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>prize_data <span class="token operator">=</span> <span class="token string">''</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>prize <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token keyword">this</span><span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'中奖位置是：'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prize<span class="token punctuation">)</span>
      <span class="token comment">// })</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//点击开始抽奖</span>
    <span class="token function">move</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>times <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;正在抽奖中，请勿重复点击&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>number_of_draws <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;今日抽奖次数已用完,明天再来吧&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>number_of_draws<span class="token operator">--</span><span class="token punctuation">;</span> <span class="token comment">// 抽奖开始，次数-1</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>speed <span class="token operator">=</span> <span class="token number">150</span><span class="token punctuation">;</span> <span class="token comment">// 每次抽奖速度初始化为150</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getUserLottery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">startRoll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//执行抽奖</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 开始转动</span>
    <span class="token function">startRoll</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// this.lampShow = !this.lampShow; // 跑马灯，小心闪瞎，谨慎使用</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>times <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 转动次数</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">oneRoll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 转动过程调用的每一次转动方法，这里是第一次调用初始化</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">usePrize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 每一次转动</span>
    <span class="token function">oneRoll</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>index<span class="token punctuation">;</span> <span class="token comment">// 当前转动到哪个位置</span>
      index <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>index <span class="token operator">=</span> index<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">usePrize</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果当前转动次数达到要求 &amp;&amp; 目前转到的位置是中奖位置</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>times <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cycle <span class="token operator">+</span> <span class="token number">10</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>prize <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 清除转动定时器</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lampShow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 白色灯隐藏</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>times <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 转动跑格子次数初始化为0，可以开始下次抽奖</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;中奖啦&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//中奖弹出提示</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>speed <span class="token operator">-=</span> <span class="token number">3</span><span class="token punctuation">;</span> <span class="token comment">// 加快转动速度</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>times <span class="token operator">&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cycle <span class="token operator">-</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>speed <span class="token operator">+=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token comment">// 抽奖即将结束，放慢转动速度</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>startRoll<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>speed<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//开始转动</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>scss<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.gameBox</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 326px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 326px<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 150px auto 0<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> red no-repeat left top<span class="token punctuation">;</span>
  <span class="token property">background-size</span><span class="token punctuation">:</span> 326px 326px<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token selector">;
  .bg1</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 4.5px<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 317px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 317px<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> yellow no-repeat center<span class="token punctuation">;</span>
    <span class="token property">background-size</span><span class="token punctuation">:</span> 317px 317px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.bg2</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 4.5px<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 317px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 317px<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> blue no-repeat center<span class="token punctuation">;</span>
    <span class="token property">background-size</span><span class="token punctuation">:</span> 317px 317px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.start</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 86px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 86px<span class="token punctuation">;</span>
    <span class="token property">background</span><span class="token punctuation">:</span> black no-repeat center<span class="token punctuation">;</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
    <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token selector">;
    p</span> <span class="token punctuation">{</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">ul</span> <span class="token punctuation">{</span>
    <span class="token selector">li</span> <span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 86px<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 86px<span class="token punctuation">;</span>
      <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 255<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0px -4px 12px 0px #fea784 inset<span class="token punctuation">,</span>
        0px -2px 22px 3px #fea784 inset<span class="token punctuation">,</span> 0px -4px 6px 6px #ffd7c8 inset<span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 8px<span class="token selector">;
      .img1</span> <span class="token punctuation">{</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> 15px auto 3px<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 35px<span class="token punctuation">;</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 35px<span class="token selector">;
        img</span> <span class="token punctuation">{</span>
          <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
          <span class="token property">height</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token selector">p</span> <span class="token punctuation">{</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token property">font-size</span><span class="token punctuation">:</span> 13px<span class="token punctuation">;</span>
        <span class="token property">font-weight</span><span class="token punctuation">:</span> 500<span class="token punctuation">;</span>
        <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>153<span class="token punctuation">,</span> 153<span class="token punctuation">,</span> 153<span class="token punctuation">,</span> 1<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.item1</span> <span class="token punctuation">{</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.item2</span> <span class="token punctuation">{</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.item3</span> <span class="token punctuation">{</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 215px<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.item4</span> <span class="token punctuation">{</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 215px<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.item5</span> <span class="token punctuation">{</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 215px<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 215px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.item6</span> <span class="token punctuation">{</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 215px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.item7</span> <span class="token punctuation">{</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 215px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.item8</span> <span class="token punctuation">{</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 25px<span class="token punctuation">;</span>
      <span class="token property">top</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.active</span> <span class="token punctuation">{</span>
      <span class="token property">background</span><span class="token punctuation">:</span> #fff2b1<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="_15、时间倒计时"><a href="#_15、时间倒计时" class="header-anchor">#</a> 15、时间倒计时</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">show_time</span><span class="token punctuation">(</span><span class="token parameter">time_end</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> time_now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前时间</span>
  time_now <span class="token operator">=</span> time_now<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> time_distance <span class="token operator">=</span> time_end <span class="token operator">-</span> time_now<span class="token punctuation">;</span> <span class="token comment">// 结束时间减去当前时间</span>
  <span class="token keyword">let</span> day<span class="token punctuation">,</span> hour<span class="token punctuation">,</span> minute<span class="token punctuation">,</span> second<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>time_distance <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 天时分秒换算</span>
    day <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>time_distance <span class="token operator">/</span> <span class="token number">86400000</span><span class="token punctuation">)</span>
    time_distance <span class="token operator">-=</span> day <span class="token operator">*</span> <span class="token number">86400000</span><span class="token punctuation">;</span>
    hour <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>time_distance <span class="token operator">/</span> <span class="token number">3600000</span><span class="token punctuation">)</span>
    time_distance <span class="token operator">-=</span> hour <span class="token operator">*</span> <span class="token number">3600000</span><span class="token punctuation">;</span>
    minute <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>time_distance <span class="token operator">/</span> <span class="token number">60000</span><span class="token punctuation">)</span>
    time_distance <span class="token operator">-=</span> minute <span class="token operator">*</span> <span class="token number">60000</span><span class="token punctuation">;</span>
    second <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>time_distance <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">)</span>

    <span class="token comment">// 时分秒为单数时、前面加零站位</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>hour <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>
      hour <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span> <span class="token operator">+</span> hour<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>minute <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>
      minute <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span> <span class="token operator">+</span> minute<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>second <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">)</span>
      second <span class="token operator">=</span> <span class="token string">&quot;0&quot;</span> <span class="token operator">+</span> second<span class="token punctuation">;</span>

    <span class="token comment">// 显示时间</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      day<span class="token punctuation">,</span>
      hour<span class="token punctuation">,</span>
      minute<span class="token punctuation">,</span>
      second
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 使用</span>
<span class="token keyword">let</span> timeData<span class="token punctuation">;</span>
<span class="token keyword">let</span> time_end <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">&quot;2022/03/06 15:11:00&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 设定结束时间</span>
time_end <span class="token operator">=</span> time_end<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> timeNum <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  timeData <span class="token operator">=</span> <span class="token function">show_time</span><span class="token punctuation">(</span>time_end<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>timeData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>timeNum<span class="token punctuation">)</span>
    timeNum <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_16、移动端关闭软键盘导致页面不下落"><a href="#_16、移动端关闭软键盘导致页面不下落" class="header-anchor">#</a> 16、移动端关闭软键盘导致页面不下落</h2> <div class="language- extra-class"><pre class="language-text"><code>&lt;input type=&quot;text&quot; @blur.prevent=&quot;inputLoseFocus&quot;&gt;

inputLoseFocus() {
  setTimeout(() =&gt; {
    window.scrollTo(0, 0);
  }, 100);
}
</code></pre></div></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-a008c6ba data-v-a008c6ba><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-a008c6ba><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-a008c6ba></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-a008c6ba></path></svg></div><canvas id="vuepress-canvas-ribbon"></canvas><div class="kanbanniang" data-v-ee8d62e6><div class="banniang-container" style="display:;" data-v-ee8d62e6><div class="messageBox" style="position:absolut;height:auto;padding:20px 10px;right:28px;bottom:170px;font-weight:bold;background:linear-gradient(270deg,#76ea8c,#0ac497);border-radius:10px;color:#fff;display:none;" data-v-ee8d62e6>
      欢迎你的关注 
    </div> <div class="operation" style="right:50px;bottom:40px;display:none;" data-v-ee8d62e6><i class="kbnfont kbn-ban-home ban-home" data-v-ee8d62e6></i> <i class="kbnfont kbn-ban-message message" data-v-ee8d62e6></i> <i class="kbnfont kbn-ban-close close" data-v-ee8d62e6></i> <a target="_blank" href="https://vuepress-theme-reco.recoluan.com/views/plugins/kanbanniang.html" data-v-ee8d62e6><i class="kbnfont kbn-ban-info info" data-v-ee8d62e6></i></a> <i class="kbnfont kbn-ban-theme skin" style="display:;" data-v-ee8d62e6></i></div> <canvas id="banniang" width="150" height="220" class="live2d" style="right:40px;bottom:-20px;opacity:0.9;" data-v-ee8d62e6></canvas></div> <div class="showBanNiang" style="display:none;" data-v-ee8d62e6>
    看板娘
  </div></div><canvas id="vuepress-canvas-cursor"></canvas><APlayer audio="" fixed="true" mini="true" autoplay="autoplay" theme="#f9bcdd" loop="loop" order="random" preload="auto" volume="0.7" mutex="true" lrc-type="0" list-folded="true" list-max-height="250" storage-name="vuepress-plugin-meting" id="aplayer-fixed"></APlayer></div></div>
    <script src="/assets/js/app.1aa2a0f6.js" defer></script><script src="/assets/js/3.0eb5227a.js" defer></script><script src="/assets/js/1.47d7d4b6.js" defer></script><script src="/assets/js/119.98962333.js" defer></script>
  </body>
</html>
